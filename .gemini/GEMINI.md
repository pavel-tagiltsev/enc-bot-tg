# Обзор проекта: enc-bot-tg

Это Telegram-бот на Node.js, созданный для внутренних нужд компании. Основная задача бота — предоставлять администраторам актуальную информацию из CRM-системы "Мой Класс" (`MoyKlass`).

## Ключевые технологии

- **Платформа:** Node.js
- **Основной фреймворк:** `telegraf` для создания Telegram-бота.
- **Взаимодействие с API:** `axios` для выполнения запросов к API "Мой Класс".
- **Планировщик задач:** `cron` для отправки регулярных уведомлений.
- **Окружение:** `dotenv` для управления переменными окружения.
- **Стиль кода:** `eslint` и `prettier` для поддержания единого стиля.

## Архитектура

Проект имеет конфигурационно-ориентированную архитектуру.

- **`server.js`**: Точка входа в приложение. Инициализирует и запускает бота.
- **`server/CompanyTgBot.js`**: Основной класс бота, который управляет командами, уведомлениями и жизненным циклом.
- **`server/config.js`**: Центральный конфигурационный файл. Он связывает команды и cron-задачи с их бизнес-логикой (`UseCases`) и шаблонами отображения (`Views`).
- **`server/UseCases/`**: Директория с бизнес-логикой. Каждый файл представляет собой отдельный сценарий (например, получение данных о долгах по абонементам).
- **`server/Helpers/`**: Вспомогательные модули, включая `MoyKlassAPI.js` для инкапсуляции логики работы с внешним API.

## Запуск и развертывание

### Переменные окружения

Для работы бота необходимо создать файлы `.env.local` (для локальной разработки) и/или `.env.prod` (для продакшена). За основу следует взять файл `.env.example`.

Ключевые переменные:
- `TELEGRAM_TOKEN`: Токен вашего Telegram-бота.
- `DEVELOPER_CHAT_ID`, `ADMIN_CHAT_ID`: ID пользователей Telegram для администрирования и получения уведомлений.
- Учетные данные для доступа к API "Мой Класс".

### Установка зависимостей
```bash
npm install
```

### Локальный запуск
```bash
npm start
```
Команда запустит бота с использованием файла `.env.local`.

### Развертывание (Production)

Проект предназначен для развертывания с использованием менеджера процессов PM2.

```bash
pm2 start ecosystem.config.json
```
Эта команда запустит приложение в режиме `production` и будет использовать переменные из файла `.env.prod`.

## Процесс разработки

### Стиль кода

Стиль кода строго регламентирован с помощью Prettier и ESLint.

- **Отступы:** 2 пробела.
- **Кавычки:** Одинарные (`'`).
- **Максимальная длина строки:** 100 символов.
- **Конец строки:** LF.

### Полезные команды

- **Форматирование кода:**
  ```bash
  npm run format
  ```
- **Проверка на ошибки линтера:**
  ```bash
  npm run lint
  ```
- **Автоматическое исправление ошибок линтера:**
  ```bash
  npm run lint:fix
  ```
